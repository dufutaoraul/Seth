# ä¸èµ›æ–¯å¯¹è¯ - AIæ™ºæ…§èŠå¤©ç³»ç»Ÿ

åŸºäº Next.js 14ã€Supabaseã€Dify API å’Œ ZPay æ„å»ºçš„æ™ºèƒ½èŠå¤©ç³»ç»Ÿã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸ¤– **AI æ™ºèƒ½å¯¹è¯** - é›†æˆ Dify å·¥ä½œæµï¼Œæä¾›ä¸“ä¸šçš„èµ›æ–¯å“²å­¦å¯¹è¯ä½“éªŒ
- ğŸ’³ **ç§¯åˆ†åˆ¶ä¼šå‘˜ç³»ç»Ÿ** - å…è´¹ç”¨æˆ·15æ¬¡/æœˆï¼Œæ ‡å‡†ä¼šå‘˜150æ¬¡/æœˆï¼Œé«˜çº§ä¼šå‘˜500æ¬¡/æœˆ
- ğŸ” **é‚®ç®±è®¤è¯ç™»å½•** - åŸºäº Supabase Auth çš„å®‰å…¨è®¤è¯ç³»ç»Ÿ
- ğŸ’° **åœ¨çº¿æ”¯ä»˜** - é›†æˆ ZPay æ”¯ä»˜ç½‘å…³ï¼Œæ”¯æŒæ”¯ä»˜å®ã€å¾®ä¿¡æ”¯ä»˜
- ğŸ“± **å“åº”å¼è®¾è®¡** - æ”¯æŒæ¡Œé¢ç«¯å’Œç§»åŠ¨ç«¯ï¼Œæµç•…çš„ç”¨æˆ·ä½“éªŒ
- âœ¨ **æ˜Ÿç©ºä¸»é¢˜ UI** - ç‚«é…·çš„æ˜Ÿç©ºèƒŒæ™¯æ•ˆæœï¼Œç¬¦åˆèµ›æ–¯å“²å­¦çš„ç¥ç§˜æ„Ÿ

## æŠ€æœ¯æ ˆ

- **å‰ç«¯**: Next.js 14, React 18, TypeScript, Tailwind CSS, Framer Motion
- **åç«¯**: Next.js API Routes, Supabase Functions
- **æ•°æ®åº“**: Supabase (PostgreSQL)
- **è®¤è¯**: Supabase Auth (é‚®ç®±ç™»å½•)
- **AIæœåŠ¡**: Dify API
- **æ”¯ä»˜**: ZPay æ”¯ä»˜ç½‘å…³
- **éƒ¨ç½²**: Vercel (æ¨è)

## å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒè¦æ±‚

- Node.js 18+
- npm æˆ– yarn

### 2. å…‹éš†é¡¹ç›®

\`\`\`bash
git clone <é¡¹ç›®åœ°å€>
cd seth-chat
\`\`\`

### 3. å®‰è£…ä¾èµ–

\`\`\`bash
npm install
\`\`\`

### 4. ç¯å¢ƒé…ç½®

å¤åˆ¶ \`.env.local\` æ–‡ä»¶å¹¶é…ç½®ä»¥ä¸‹ç¯å¢ƒå˜é‡ï¼š

\`\`\`env
# Supabaseé…ç½®
NEXT_PUBLIC_SUPABASE_URL=your_supabase_url
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_supabase_anon_key
SUPABASE_SERVICE_ROLE_KEY=your_supabase_service_role_key

# Difyé…ç½®
DIFY_API_URL=https://pro.aifunbox.com/v1
DIFY_API_KEY=your_dify_api_key

# ZPayé…ç½®
ZPAY_PID=your_zpay_pid
ZPAY_KEY=your_zpay_key
ZPAY_GATEWAY=https://zpayz.cn

# ç½‘ç«™é…ç½®
NEXT_PUBLIC_SITE_URL=http://localhost:3000
\`\`\`

### 5. æ•°æ®åº“è®¾ç½®

1. åœ¨ Supabase æ§åˆ¶å°ä¸­æ‰§è¡Œ \`supabase_schema.sql\` ä¸­çš„ SQL è„šæœ¬
2. ç¡®ä¿æ‰€æœ‰è¡¨å’Œå‡½æ•°éƒ½åˆ›å»ºæˆåŠŸ
3. é…ç½® Row Level Security (RLS) ç­–ç•¥

### 6. å¯åŠ¨å¼€å‘æœåŠ¡å™¨

\`\`\`bash
npm run dev
\`\`\`

è®¿é—® [http://localhost:3000](http://localhost:3000) æŸ¥çœ‹æ•ˆæœã€‚

## æ•°æ®åº“æ¶æ„

ç³»ç»ŸåŒ…å«ä»¥ä¸‹ä¸»è¦æ•°æ®è¡¨ï¼š

- \`user_membership_types\` - ä¼šå‘˜ç­‰çº§é…ç½®
- \`user_credits\` - ç”¨æˆ·ç§¯åˆ†è®°å½•
- \`chat_sessions\` - èŠå¤©ä¼šè¯
- \`chat_messages\` - èŠå¤©æ¶ˆæ¯
- \`payment_orders\` - æ”¯ä»˜è®¢å•
- \`user_login_logs\` - ç™»å½•æ—¥å¿—
- \`credit_usage_logs\` - ç§¯åˆ†ä½¿ç”¨è®°å½•

## éƒ¨ç½²æŒ‡å—

### Vercel éƒ¨ç½²

1. å°†ä»£ç æ¨é€åˆ° GitHub
2. åœ¨ Vercel ä¸­å¯¼å…¥é¡¹ç›®
3. é…ç½®ç¯å¢ƒå˜é‡
4. éƒ¨ç½²å®Œæˆ

### å…¶ä»–å¹³å°

é¡¹ç›®åŒæ ·æ”¯æŒéƒ¨ç½²åˆ° Netlifyã€Railway ç­‰å¹³å°ã€‚

## ä¼šå‘˜ç³»ç»Ÿ

- **å…è´¹ç”¨æˆ·**: 15æ¬¡å¯¹è¯/æœˆï¼ŒÂ¥0
- **æ ‡å‡†ä¼šå‘˜**: 150æ¬¡å¯¹è¯/æœˆï¼ŒÂ¥145
- **é«˜çº§ä¼šå‘˜**: 500æ¬¡å¯¹è¯/æœˆï¼ŒÂ¥360

## æ”¯ä»˜æµç¨‹

1. ç”¨æˆ·é€‰æ‹©ä¼šå‘˜å¥—é¤
2. åˆ›å»ºæ”¯ä»˜è®¢å•
3. è·³è½¬åˆ° ZPay æ”¯ä»˜é¡µé¢
4. æ”¯ä»˜å®Œæˆåå›è°ƒé€šçŸ¥
5. ç³»ç»Ÿè‡ªåŠ¨æ›´æ–°ç”¨æˆ·ç§¯åˆ†å’Œä¼šå‘˜çŠ¶æ€

## API æ¥å£

- \`POST /api/chat\` - å‘é€æ¶ˆæ¯
- \`POST /api/payment/create\` - åˆ›å»ºæ”¯ä»˜è®¢å•
- \`POST /api/payment/notify\` - æ”¯ä»˜å›è°ƒé€šçŸ¥

## å¼€å‘è¯´æ˜

### é¡¹ç›®ç»“æ„

\`\`\`
â”œâ”€â”€ app/                    # Next.js 13+ åº”ç”¨ç›®å½•
â”‚   â”œâ”€â”€ api/               # API è·¯ç”±
â”‚   â”œâ”€â”€ chat/              # èŠå¤©é¡µé¢
â”‚   â”œâ”€â”€ membership/        # ä¼šå‘˜ä¸­å¿ƒ
â”‚   â””â”€â”€ payment/           # æ”¯ä»˜ç›¸å…³é¡µé¢
â”œâ”€â”€ components/            # React ç»„ä»¶
â”œâ”€â”€ lib/                   # å·¥å…·åº“
â”‚   â”œâ”€â”€ supabase.ts       # Supabase å®¢æˆ·ç«¯
â”‚   â”œâ”€â”€ dify.ts           # Dify API
â”‚   â””â”€â”€ zpay.ts           # ZPay æ”¯ä»˜
â””â”€â”€ public/               # é™æ€èµ„æº
\`\`\`

### æ ¸å¿ƒåŠŸèƒ½

1. **èŠå¤©ç³»ç»Ÿ**: åŸºäº Dify API çš„æ™ºèƒ½å¯¹è¯
2. **ç§¯åˆ†ç³»ç»Ÿ**: æ¯æ¬¡å¯¹è¯æ¶ˆè€—1ä¸ªç§¯åˆ†
3. **ä¼šå‘˜ç³»ç»Ÿ**: ä¸åŒç­‰çº§çš„æœˆåº¦ç§¯åˆ†é…é¢
4. **æ”¯ä»˜ç³»ç»Ÿ**: ZPay ç½‘å…³é›†æˆ

## æ³¨æ„äº‹é¡¹

- ç¡®ä¿ Supabase RLS ç­–ç•¥æ­£ç¡®é…ç½®
- ZPay å›è°ƒåœ°å€éœ€è¦å…¬ç½‘å¯è®¿é—®
- Dify API å¯†é’¥éœ€è¦å¦¥å–„ä¿ç®¡
- ç”Ÿäº§ç¯å¢ƒè¯·ä½¿ç”¨ HTTPS

## è®¸å¯è¯

MIT License

## è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜è¯·è”ç³»ï¼š[your-email@example.com]